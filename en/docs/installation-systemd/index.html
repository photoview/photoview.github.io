<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Use with systemd - Photoview Documentation</title><link rel="stylesheet" href="/main.css"><link rel="stylesheet" href="/docs/style.css"><link href="/docs/syntax-theme.css" rel="stylesheet"><script defer="defer" data-domain="photoview.github.io" src="https://analytics.qpqp.dk/js/plausible.outbound-links.js"></script><script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script></head><body><div class="mx-4 relative"><div class="max-w-screen-2xl m-auto flex items-start min-h-screen"><aside class="w-56 sticky top-0 docs-nav flex-shrink-0"><div class="overflow-y-auto max-h-screen pr-4"><a href="/"><img class="my-8" src="/images/logo-large.svg" alt="Photoview logo" height="60"> </a><input id="nav-search-field" type="search" placeholder="Search" class="pointer mb-4 w-full py-2 px-3 text-sm border border-gray-200 rounded-md"><nav class="mb-8"><ul><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/">Introduction</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/getting-started/">Getting Started</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/faq/">FAQ</a></li><li class=""><span class="ml-3 mt-6 block uppercase text-gray-600 font-bold text-xs tracking-wider">Installation</span><ul><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/installation-docker/">Setup with Docker</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/installation-manual/">Manual Setup</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm bg-blue-50 text-primaryDark hover:text-primaryDark" href="/en/docs/installation-systemd/" aria-current="page">Use with systemd</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/installation-environment-variables/">Environment Variables</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/installation-reverse-proxies/">Reverse Proxy</a></li></ul></li><li class=""><span class="ml-3 mt-6 block uppercase text-gray-600 font-bold text-xs tracking-wider">Usage</span><ul><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-basic-overview/">Basic Overview</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-nextcloud/">Using with Nextcloud</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-people/">Face recognition</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-places/">Places</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-scanner/">File scanner</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-settings/">Settings Page</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/usage-sharing/">Share albums and media</a></li></ul></li><li class=""><span class="ml-3 mt-6 block uppercase text-gray-600 font-bold text-xs tracking-wider">Contributing</span><ul><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/contribute-how-to/">How to contribute</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/contribute-feature-request/">Reporting bugs</a></li><li><a class="px-3 py-1 block no-underline hover:no-underline text-sm text-black hover:text-gray-900 hover:bg-gray-100" href="/en/docs/contribute-setup-locally/">Setup Development Environment</a></li></ul></li></ul></nav></div></aside><style>.docs-nav::before {
        content: '';
        background-color: rgb(249, 250, 251);
        position: absolute;
        z-index: -1;
        top: 0;
        right: 0;
        width: 100vw;
        height: 100vh;
      }</style><aside id="content-toc" class="w-48 sticky docs-toc order-3 flex-shrink-0"><span class="block uppercase text-gray-600 font-bold text-xs tracking-wider pt-0">Contents</span><nav class="toc"><ol><li><a href="#using-with-systemd">Using with systemd</a><ol><li><a href="#using-the-systemd-unit-file">Using the systemd unit file</a></li></ol></li></ol></nav></aside><main id="primary-content" class="mb-40 w-full px-14 py-14"><header class="flex justify-between items-center"><h1>Use with systemd</h1><div class="flex items-center"><a title="Edit on GitHub" class="text-gray-500 hover:text-primaryDark no-underline" href="https://github.com/photoview/photoview.github.io/edit/master/./src/en/docs/installation-systemd.md"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-3"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg> </a><select class="ml-5" id="lg-switcher" onchange="changeLanguage()"><option class="lg-switcher-item" selected="selected" value="/en/docs/installation-systemd/">English</option><option class="lg-switcher-item" value="/fr/docs/installation-systemd/">Fran√ßais</option></select><script>function changeLanguage() {
      document.location.href=document.getElementById("lg-switcher").value;
    }</script></div></header><p>You can optionally use <code>systemd</code> to manage photoview and start the program at boot. It also allows the program to run as its own system user, enhancing the security of the process.</p><p>To get started, follow the <a href="/en/docs/installation-manual/">Manual Setup Installation guide</a>. When you get to the <em>Copy needed files</em> section, replace those steps with the steps listed below.</p><h2 id="using-with-systemd" tabindex="-1"><a class="header-anchor" href="#using-with-systemd" aria-label="Anchor"></a> Using with <code>systemd</code></h2><p>The first three files in the steps below cause <code>systemd</code> to run photoview as the <code>user:group</code> equal to <code>photoview:photoview</code>. This limits the permissions of the program, (slightly) enhancing security by limiting its access to files and directories to which the process has explicitly been given access.</p><p>It also necessitates your <code>PHOTOVIEW_MEDIA_CACHE</code> (and <code>PHOTOVIEW_SQLITE_PATH</code> if you are using <code>sqlite</code>) directory(ies) to be read- and write-able by the <code>photoview</code> user. If this is the first time you are installing photoview, the permissions should be handled automatically. If you are upgrading, and there are already files in that directory, you need to change the ownership, recursively, of those directories and their contents using <code>chown</code>.</p><p>Finally, <code>systemd</code> typically operates on an hierarchy of system paths. As such, instead of installing everything together in <code>/opt/</code>, the program files will be placed under <code>/usr</code>, <code>/lib/</code>, and <code>/var</code>. Be aware that, regardless of the path, the cache files in <code>PHOTOVIEW_MEDIA_CACHE</code> can be very large. If this will cause issues, you can change the installation location. If you do so, the <code>photoview.service</code> and <code>photoview.tmpfiles</code> will need to be altered, as well, if you plan to use the <code>systemd</code> unit file.</p><blockquote><p>Reminder: These steps replace <a href="#copy-needed-files">Copy needed files</a> from the manual installation guide.</p></blockquote><ol><li>Create the <code>photoview</code> user and group<ul><li><code>$ sudo adduser photoview --system --group --no-create-home</code></li></ul></li><li>Copy <code>systemd</code> files:<ul><li><code>systemd/photoview.service</code> to <code>/etc/systemd/system/multi-user.target/photoview.service</code></li><li><code>systemd/photoview.sysusers.conf</code> to <code>/usr/lib/sysusers.d/photoview.conf</code></li><li><code>systemd/photoview.tmpfiles</code> to <code>/usr/lib/tmpfiles.d/photoview.conf</code></li></ul><blockquote><p>If you do not plan to use <code>sqlite</code>, remove the 2nd line from <code>systemd/photoview.tmpfiles</code> and comment out the line <code>ReadWritePaths=/var/lib/photoview</code> in <code>systemd/photoview.service</code> before copying.</p></blockquote></li><li>Make the directories where the program files will be placed :<blockquote><p>Note: The <code>install</code> command, as demonstrated below, creates these required directories for you.</p></blockquote><ul><li><code>/usr/share/webapps/photoview-ui</code></li><li><code>/usr/lib/photoview</code></li><li><code>/var/cache/photoview/media_cache</code></li><li><code>/var/lib/photoview</code> (for sqlite path, if used)</li></ul></li><li>Copy built program files into appropriate locations</li><li>If you are upgrading from a state where you were not using the <code>systemd</code> service:<ul><li>Change ownership of the media cache directory (and sqlite path, if used)<ul><li><code>$ sudo chown -R photoview:photoview /var/cache/photoview</code></li><li><code>$ sudo chown -R photoview:photoview /var/lib/photoview</code></li></ul></li></ul></li><li>If this is a fresh installation, ensure the paths are owned and read-/write-able by the photoview user and group</li></ol><p>A synopsis of the previous steps by example:</p><pre class="language-shell"><code class="language-shell">$ <span class="token function">sudo</span> adduser photoview --system --group --no-create-home<br>$ <span class="token builtin class-name">cd</span> /opt/photoview<br>$ <span class="token function">sudo</span> <span class="token function">install</span> -Dm0644 -t <span class="token string">"/usr/lib/systemd/system"</span> <span class="token string">"/opt/photoview/systemd/photoview.service"</span><br>$ <span class="token function">sudo</span> <span class="token function">install</span> -Dm0644 <span class="token string">"/opt/photoview/systemd/photoview.sysusers.conf"</span> <span class="token string">"/usr/lib/sysusers.d/photoview.conf"</span><br>$ <span class="token function">sudo</span> <span class="token function">install</span> -Dm0644 <span class="token string">"/opt/photoview/systemd/photoview.tmpfiles"</span> <span class="token string">"/usr/lib/tmpfiles.d/photoview.conf"</span><br>$ <span class="token function">sudo</span> <span class="token function">install</span> -d <span class="token string">"/var/cache/photoview/media_cache"</span><br>$ <span class="token function">sudo</span> <span class="token function">chown</span> -R photoview:photoview /var/cache/photoview<br>$ <span class="token builtin class-name">cd</span> /opt/photoview/ui/dist<br>$ <span class="token function">sudo</span> <span class="token function">find</span> * -type f -exec <span class="token function">install</span> -Dm0644 <span class="token string">"{}"</span> <span class="token string">"/usr/share/webapps/photoview-ui/{}"</span> <span class="token punctuation">\</span><span class="token punctuation">;</span><br>$ <span class="token builtin class-name">cd</span> /opt/photoview/api<br>$ <span class="token function">sudo</span> <span class="token function">install</span> -Dm0755 -t <span class="token string">"/usr/lib/photoview"</span> <span class="token string">"/opt/photoview/api/photoview"</span><br>$ <span class="token function">sudo</span> <span class="token function">ln</span> -s /usr/lib/photoview/photoview /usr/bin/photoview<br>$ <span class="token function">sudo</span> <span class="token function">find</span> data -type f -exec <span class="token function">install</span> -Dm0644 <span class="token string">"{}"</span> <span class="token string">"/usr/lib/photoview/{}"</span> <span class="token punctuation">\</span><span class="token punctuation">;</span><br>$ <span class="token function">sudo</span> <span class="token function">install</span> -Dm0644 <span class="token string">"/opt/photoview/api/example.env"</span> <span class="token string">"/etc/photoview.env"</span><br><span class="token comment"># The next two lines are if you plan to use `sqlite`</span><br>$ <span class="token function">sudo</span> <span class="token function">install</span> -d <span class="token string">"/var/lib/photoview"</span><br>$ <span class="token function">sudo</span> <span class="token function">chown</span> -R photoview:photoview /var/lib/photoview</code></pre><h3 id="using-the-systemd-unit-file" tabindex="-1"><a class="header-anchor" href="#using-the-systemd-unit-file" aria-label="Anchor"></a> Using the <code>systemd</code> unit file</h3><ul><li>To start (or stop) the photoview service:<ul><li><code>$ sudo systemctl &lt;start/stop&gt; photoview.service</code></li></ul></li><li>To enable (or disable) the unit file to (no longer) start automatically during boot:<ul><li><code>$ sudo systemctl &lt;enable/disable&gt; photoview.service</code></li></ul></li><li>To view status of the unit file:<ul><li><code>$ sudo systemctl status photoview.service</code></li></ul><blockquote><p>Use this to print error messages if your <code>photoview</code> instance fails at runtime</p></blockquote></li><li>To continuously print to screen (a.k.a. <code>follow</code>) all messages from the service while it is running:<ul><li><code>$ sudo journalctl -f -b0 -u photoview.service</code></li></ul><blockquote><p>Useful in debugging while running consecutive <code>start/stop</code> commands in a separate terminal</p></blockquote></li></ul></main></div></div><div id="search-overlay" class="hidden"><div id="search-dimmer" class="fixed top-0 left-0 w-full h-full bg-black opacity-10"></div><div class="fixed top-20 left-1/2 transform -translate-x-1/2 bg-white shadow-lg border border-gray-200 rounded-md p-4 w-40rem overflow-y-auto h-3/4" role="dialog"><input id="search-field" type="search" class="mb-4 w-full py-2 px-3 text-sm border border-gray-200 rounded-md" placeholder="Search" aria-autocomplete="list" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" enterkeyhint="search" aria-controls="search-results-box"><div role="listbox" aria-label="Search" id="search-results-box" class="">Loading results...</div></div></div><script defer="defer" src="/docs/docs-scripts.js"></script></body></html>